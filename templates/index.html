<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logos Ai 0.1</title>
    <!-- Base Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='base.css') }}">
    <!-- Layout Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='layout.css') }}">
    <!-- Component Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='sidebar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='chat.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='settings.css') }}">
    <!-- highlight.js CSS theme (e.g., github-dark) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <!-- Google Fonts Import -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400&family=Lora:wght@400&family=Merriweather:wght@400&family=Noto+Sans:wght@400&family=Nunito+Sans:wght@400&family=Open+Sans:wght@400&family=Poppins:wght@400&family=Raleway:wght@400&family=Roboto+Slab:wght@400&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app-container"> <!-- Renamed container for clarity and structure -->
        <div id="sidebar">
            <div class="sidebar-header">
                 <h2>Logos Ai 0.1</h2>
                 <button id="new-chat-button" title="Start a new conversation">New Chat</button>
                 <button id="create-folder-button" title="Create a new folder">
                     <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-folder-plus" viewBox="0 0 16 16">
                       <path d="m.5 3 .04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14H9v-1H2.826a1 1 0 0 1-.995-.91l-.637-7A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09L14.54 8h1.005l.256-2.819A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2m5.672-1a1 1 0 0 1 .707.293L7.586 3H2.19c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672z"/>
                       <path d="M13.5 10a.5.5 0 0 1 .5.5V12h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V13h-1.5a.5.5 0 0 1 0-1H13v-1.5a.5.5 0 0 1 .5-.5"/>
                     </svg>
                     <span class="visually-hidden">Create Folder</span>
                 </button>
            </div>
            <div id="sidebar-loading-spinner" class="spinner-container" aria-label="Loading conversations...">
                <!-- Spinner will be styled with CSS -->
            </div>
            <ul id="conversation-list"> <!-- Renamed from history-list -->
                <!-- Conversation items will be added here by JS -->
            </ul>
        </div>
        <!-- Left Panel Removed -->
        <div id="main-content">
            <!-- Sidebar Toggle Button (Moved Here for Mobile) -->
            <button id="sidebar-toggle-button" aria-label="Toggle sidebar" aria-expanded="false">
                <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5"/>
                </svg>
            </button>
            <!-- Main Header Container Removed -->
            <!-- Settings Button (Moved Here - Outside Wrapper) -->
            <button id="open-settings-button" class="settings-link" title="Settings">
                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16" aria-hidden="true">
                  <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311a1.464 1.464 0 0 1 .872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1-.872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1-.872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1 .872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.858 2.929 2.929 0 0 1 0 5.858"/>
                </svg>
                <span class="visually-hidden">Settings</span>
            </button>
            <!-- Level 1 Settings Popover (Moved Here - Outside Wrapper) -->
            <div id="settings-popover-level1" class="settings-popover">
                 <ul>
                     <li><a href="#" data-target-modal="settings-modal-main" data-target-tab="account">Account Settings</a></li>
                     <li><a href="#" data-target-modal="settings-modal-main" data-target-tab="chat">Chat Settings</a></li>
                     <li><a href="#" data-target-modal="settings-modal-main" data-target-tab="theme">Theme Settings</a></li>
                     <li><hr></li>
                     <li><a href="{{ url_for('auth.logout') }}">Logout</a></li>
                 </ul>
             </div>
            <div class="chat-area-wrapper"> <!-- Wrapper for chatbox and input -->
                <div id="chat-box">
                    <!-- Chat messages will appear here -->
                </div>
                <div id="input-area">
                    <!-- Single wrapper for the whole input box -->
                    <div class="input-wrapper">
                        <!-- Textarea takes the top part -->
                        <textarea id="user-input" placeholder="Converse com Logos Ai 0.1..." rows="1"></textarea>
                        <!-- Row for action buttons at the bottom -->
                        <div class="input-actions-row">
                            <!-- Button to trigger file input popover -->
                            <button id="attach-file-button" class="input-action-button attach-button" title="Anexar arquivo" aria-haspopup="true" aria-expanded="false">
                                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                  <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"/>
                                </svg>
                                <span class="visually-hidden">Anexar arquivo</span>
                            </button>
                            <!-- Attachment Popover Menu -->
                            <div id="attach-popover" class="attach-popover" style="display: none;">
                                 <ul>
                                    <li><button data-action="trigger-file-input">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-paperclip" viewBox="0 0 16 16"><path d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0z"/></svg>
                                        <span>Arquivos</span>
                                    </button></li>
                                    <li><button data-action="upload-image"> <!-- Removed disabled -->
                                         <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-image" viewBox="0 0 16 16"><path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/><path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1z"/></svg>
                                         <span>Imagem</span>
                                    </button></li>
                                    <li><button data-action="transcribe-audio">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-soundwave" viewBox="0 0 16 16">
                                          <path fill-rule="evenodd" d="M8.5 2a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-1 0v-11a.5.5 0 0 1 .5-.5m-2 2a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5m4 0a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5m-6 1.5A.5.5 0 0 1 5 6v4a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m8 0a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m-10 1A.5.5 0 0 1 3 7v2a.5.5 0 0 1-1 0V7a.5.5 0 0 1 .5-.5m12 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0V7a.5.5 0 0 1 .5-.5"/>
                                        </svg>
                                        <span>√Åudio</span>
                                    </button></li>
                                </ul>
                            </div>
                            <!-- Placeholder for file preview -->
                            <div id="file-preview-container" style="display: none;">
                                <!-- Preview content will be injected here by JS -->
                            </div>
                            <!-- Hidden file input -->
                            <input type="file" id="file-input" style="display: none;" accept=".txt,.pdf,.png,.jpg,.jpeg,.gif,.webp,audio/wav,audio/mp3,audio/aiff,audio/aac,audio/ogg,audio/flac,.wav,.mp3,.aiff,.aac,.ogg,.flac">
                            <!-- Spacer to push send/mic buttons to the right -->
                            <div style="flex-grow: 1;"></div>
                             <!-- Send button - Paper Airplane Icon -->
                            <button id="send-button" class="input-action-button send-button" title="Enviar mensagem">
                                 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-send" viewBox="0 0 16 16">
                                   <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"/>
                                 </svg>
                                 <span class="visually-hidden">Enviar mensagem</span>
                            </button>
                            <!-- Placeholder for Mic button -->
                            <button class="input-action-button mic-button" title="Usar microfone (Em breve)" disabled>
                                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-mic-fill" viewBox="0 0 16 16">
                                  <path d="M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0z"/>
                                  <path d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5"/>
                                </svg>
                                 <span class="visually-hidden">Usar microfone</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div> <!-- End new wrapper -->
        </div>
        <!-- Overlay para escurecer o fundo quando a sidebar estiver aberta em mobile -->
        <div class="sidebar-overlay"></div>
    </div>

    <!-- Markdown & Sanitization Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.8/dist/purify.min.js"></script>
    <!-- Syntax Highlighting Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- Your custom script (must come AFTER libraries) -->
    <script type="module" src="{{ url_for('static', filename='script.js') }}"></script>
    <!-- Settings modal HTML removed, handled by /settings route -->
    <script src="{{ url_for('static', filename='settings.js') }}"></script>

    <!-- Level 2 Settings Modal (Moved from settings.html) -->
    <!-- Settings Modal HTML is now loaded dynamically by script.js -->
    <!-- Placeholder div where the modal will be injected -->
    <div id="settings-modal-placeholder"></div>
</body>
</html>